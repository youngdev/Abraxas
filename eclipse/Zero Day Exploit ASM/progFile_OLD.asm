; label header
	lbl "loop" #100
	lbl "end" #200
	lbl "done" #200

lev r15 #1024 #127

mov r0 [0]
add r0 r0 #1
;Required to initialize the quantum drive
;reg #0 #0
;qntm #10 #0
;
jmp "loop"
; Old disk IO system, skipped by the loop jump instruction
	mov r0 #500
	push r0
	push r1
	mov r0 0x0003_0200
	mov r1 0x0000_0200
	str "this is a test!" [0]
	int #13
	mov r0 0x0002_0200
	mov r1 0x0200_0200
	int #13
	ldr "var" [512]
	pop r1
	pop r0
	mov r0 #56
:loop
	add r1 r1 #1
	cmp r0 r1
	jmp_eq "end"
	
	set "TMPMEM" R1
	push [^TMPMEM]
	jmp_ne "loop"
:end
	mov r0 0x0002_0200
	lsr_ne r0 r0 #16
	and r0 r0 0xffff
	mov r1 r0
	
	jmp_ne "done"
	
	cmp r5 #1
	jmp "end"
:done

mov r0 [1]
lsr r0 r0 #24
and r0 r0 0xff
lock "HLT" #127
reg #1 #512
str "mov r1 r0" [512]
str "ret" [516]
swi #1
hlt
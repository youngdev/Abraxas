package com.fifthdimensionsoftware.asm.types;

import com.fifthdimensionsoftware.asm.ArmCore;

public class GENERIC extends ARG
{
	public GENERIC(String argData)
	{
		super(argData);
	}

	@Override
	public int resolveArgument() 
	{
		for(ArgTypes type : ArgTypes.values())
		{
			if(type != ArgTypes.ARG && type.verifyType(argData))
			{
				switch(type.name())
				{
				case "REG":
					return ArmCore.getInstance().getRegister(Integer.parseInt(this.argData.replace("R", "")));
				case "MEM":
					return ArmCore.getInstance().getMemory(Integer.parseInt(argData.replace("[", "").replace("]", "")));
				case "IMM":
					return Integer.parseInt(argData.replace("#", ""));
				case "STR":
					return argData.length();
				case "VAR":
					return ArmCore.getInstance().getVar(argData.replace("^", "")).resolveArgument();
				case "MEMVAR":
					return ArmCore.getInstance().getMemory(ArmCore.getInstance().getVar(argData.replace("^", "").replace("[", "").replace("]", "")).resolveArgument());
				}
			}
		}
		return 0;
	}
	
	public String resolveString()
	{
		return this.isString() ? this.argData.replace("\"", "") : this.resolveArgument() + "";
	}
	
	public boolean isString()
	{
		return ArgTypes.STR.verifyType(argData);
	}
}
enum ArgTypes
{
	REG ("^R\\d?\\d"),
	ARG (".+"),
	MEM ("^\\[\\d+\\]$"),
	IMM ("^#\\d+"),
	STR ("\\\".+\\\""),
	VAR ("\\^.+"),
	MEMVAR ("^\\[\\^.+\\]$");
	
	private String regex = "";
	
	private ArgTypes(String regParam)
	{
		this.regex = regParam;
	}
	
	public boolean verifyType(String arg)
	{
		return arg.matches(this.regex);
	}
}
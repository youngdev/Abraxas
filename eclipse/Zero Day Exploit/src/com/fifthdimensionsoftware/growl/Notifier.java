package com.fifthdimensionsoftware.growl;

import java.io.IOException;
import java.io.OutputStream;
import java.io.PrintStream;
import java.util.HashMap;

import com.fifthdimensionsoftware.game.ZeroDayExploit;

import net.sf.libgrowl.Application;
import net.sf.libgrowl.Notification;

import static com.fifthdimensionsoftware.game.ZeroDayExploit.*;

public class Notifier
{
	private static HashMap<String, Application> customApps = new HashMap<String, Application>();
	
	public void pushSystemMessage(String subject, String message)
	{
		if(isGrowlAllowed)
			globalGrowl.notify(new Notification(globalApp, notificationTypes[0], subject, message));
	}
	
	public void pushCodeMessage(String application, String iconPath, String subject, String message)
	{
		if(isGrowlAllowed)
		{
			PrintStream tmpOut = System.out;
			System.setOut(new PrintStream(new OutputStream(){
					public void write(int arg0) throws IOException {}
			}));
			Application actionApp = null;
			if (customApps.containsKey(application)) {
				actionApp = customApps.get(application);
			} else {
				Application newApp = new Application(application, ZeroDayExploit.filterPath("disk", iconPath, "png"));
				globalGrowl.register(newApp, notificationTypes);
				actionApp = newApp;
				customApps.put(application, newApp);
			}
			globalGrowl.notify(new Notification(actionApp,
					notificationTypes[0], subject, message));
			System.setOut(tmpOut);
		}
	}
}

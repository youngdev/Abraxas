package com.fifthdimensionsoftware.lua;

import java.io.*;
import java.util.*;

public class TTY 
{
	private static HashMap<String,PrintStream> terminals = new HashMap<String,PrintStream>();
	private static HashMap<PrintStream,OutputStream> streams = new HashMap<PrintStream,OutputStream>();
	
	public static PrintStream getTerminal(String name)
	{
		if(terminals.containsKey(name))
			return terminals.get(name);
		else
		{
			ByteArrayOutputStream os = new ByteArrayOutputStream();
			terminals.put(name, new PrintStream(os));
			streams.put(getTerminal(name), os);
			return getTerminal(name);
		}
	}
	
	public static void destroyTerminal(String name)
	{
		terminals.remove(name);
	}
	
	public static String getContents(PrintStream terminal) throws UnsupportedEncodingException
	{
		if(streams.get(terminal) instanceof ByteArrayOutputStream)
			return ((ByteArrayOutputStream)streams.get(terminal)).toString("UTF8");
		else
			return "";
			
	}
	
	public static String getContents(String terminal) throws Exception
	{
		if(streams.get(getTerminal(terminal)) instanceof ByteArrayOutputStream)
			return ((ByteArrayOutputStream)streams.get(getTerminal(terminal))).toString("UTF8");
		else
			return "";
	}
	
	public static PrintStream getNullTerminal(String name)
	{
		if(terminals.containsKey(name))
			return terminals.get(name);
		else
		{
			NullOutputStream os = new NullOutputStream();
			terminals.put(name, new PrintStream(os));
			streams.put(getTerminal(name), os);
			return getTerminal(name);
		}
	}
}

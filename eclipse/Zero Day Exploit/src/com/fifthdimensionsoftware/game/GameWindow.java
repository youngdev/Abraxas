package com.fifthdimensionsoftware.game;

import java.awt.FlowLayout;
import java.awt.Graphics;
import java.awt.Graphics2D;
import java.awt.event.MouseEvent;
import java.awt.event.MouseListener;
import java.awt.image.BufferedImage;

import javax.swing.JFrame;

import com.fifthdimensionsoftware.lua.ExecutionCore;

public class GameWindow extends JFrame implements MouseListener{

	private static final long serialVersionUID = 4686662884255670207L;
	
	public BufferedImage doubleBuffer;
	public Graphics2D bufferGraphics;
	public WindowManager windowManager = new WindowManager();
	
	public GameWindow(String windowTitle)
	{
		super(windowTitle);
		setLayout(new FlowLayout());
        addMouseListener(this);
	}
	
	@Deprecated
	public void pushBuffer(Graphics g)
	{
		if(g != null && this.doubleBuffer != null)
		{
			g.drawImage(this.doubleBuffer, 0, 0, this.getWidth(), this.getHeight(), this);
		}
	}
	
	public Graphics2D bufferGraphics()
	{
		return this.bufferGraphics;
	}
	
	public void initializeBuffer()
	{
		this.doubleBuffer = new BufferedImage(this.getWidth(), this.getHeight(), BufferedImage.TYPE_4BYTE_ABGR);
		this.bufferGraphics = this.doubleBuffer.createGraphics();
	}
	
	public void repaint()
	{
		this.windowManager.repaint();
		this.pushBuffer(this.getGraphics());
	}
	
	public void paint(Graphics g)
	{
		if(g != null && this.doubleBuffer != null)
		{
			g.drawImage(this.doubleBuffer, 0, 0, this.getWidth(), this.getHeight(), this);
		}
	}

	@Override
	public void mouseClicked(MouseEvent arg0) 
	{
		for(String item : ZeroDayExploit.getWindow().listenerMethods())
		{
			if(ZeroDayExploit.getWindow().region(item).contains(arg0.getX(), arg0.getY()))
			{
				ExecutionCore.executeFunctionAsync(item.split("\\|")[1], item.split("\\|")[0]);
				return;
			}
		}
	}

	@Override
	public void mouseEntered(MouseEvent arg0)
	{
		
	}

	@Override
	public void mouseExited(MouseEvent arg0)
	{
		
	}

	@Override
	public void mousePressed(MouseEvent arg0)
	{
		
	}

	@Override
	public void mouseReleased(MouseEvent arg0)
	{
		
	}
}

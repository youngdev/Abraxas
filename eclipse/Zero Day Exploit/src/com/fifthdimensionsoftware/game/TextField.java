package com.fifthdimensionsoftware.game;

import java.awt.Color;
import java.awt.Graphics2D;
import java.awt.Point;

import org.newdawn.slick.Graphics;

import com.fifthdimensionsoftware.lua.ExecutionCore;


public class TextField 
{
	private Color primaryColorLegacy = Color.white, borderColorLegacy = Color.black, textColorLegacy = Color.black;
	
	private org.newdawn.slick.Color primaryColor = org.newdawn.slick.Color.white, borderColor = org.newdawn.slick.Color.black, textColor = org.newdawn.slick.Color.black;
	
	public int x,y,width,height;
	String text = "", func = "", script = "boot";
	public boolean isActive = false;
	
	public TextField(int x, int y, int width, int height, String func, String script)
	{
		this.x = x;
		this.y = y;
		this.width = width;
		this.height = height;
		this.func = func;
		this.script = script;
	}
	
	public void paintLegacy(Graphics2D g)
	{
		//Store the old color
		Color tmpColor = g.getColor();
		
		g.setColor(primaryColorLegacy);
		g.fillRect(x, y, width, height);
		g.setColor(borderColorLegacy);
		g.drawRect(x, y, width, height);
		g.setColor(textColorLegacy);
		if(this.isActive)
			g.drawString(text+"_", x+10, y + 11);
		else
			g.drawString(text, x+10, y + 11);
		
		//Reset the old color
		g.setColor(tmpColor);
	}
	
	public String getText()
	{
		return this.text;
	}
	
	public void setColorsLegacy(Color prime, Color border, Color text)
	{
		this.primaryColorLegacy = prime;
		this.borderColorLegacy = border;
		this.textColorLegacy = text;
	}
	
	public void setColors(org.newdawn.slick.Color prime, org.newdawn.slick.Color border, org.newdawn.slick.Color text)
	{
		this.primaryColor = prime;
		this.borderColor = border;
		this.textColor = text;
	}
	
	public void write(char c) 
	{
		this.write(c + "");
	}

	public void write(String character)
	{
		if(character.equals("\n") && !this.func.isEmpty())
		{
			ExecutionCore.executeFunction(this.script, this.func);
		}else
			this.text += character;
	}
	
	public void backspace()
	{
		this.text = !this.text.isEmpty() ? this.text.substring(0, this.text.length()-1) : "";
	}

	public void paint(Graphics g, Point modPoint) 
	{
		org.newdawn.slick.Color tmpColor = g.getColor();
		
		g.setColor(primaryColor);
		g.fillRect(modPoint.x + x, modPoint.y + y, width, height);
		g.setColor(borderColor);
		g.drawRect(modPoint.x + x, modPoint.y + y, width, height);
		g.setColor(textColor);
		if(this.isActive)
			g.drawString(text+"_", x+10, y + 11);
		else
			g.drawString(text, x+10, y + 11);
		
		//Reset the old color
		g.setColor(tmpColor);
	}
}

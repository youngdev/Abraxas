package com.fifthdimensionsoftware.game;

import java.awt.Color;
import java.awt.Graphics2D;
import java.awt.Rectangle;
import java.awt.image.BufferedImage;
import java.util.HashMap;

import com.fifthdimensionsoftware.lua.LuaJava;

public class WindowManager {
	private HashMap<String,Window> windows = new HashMap<String,Window>();
	private HashMap<String, Rectangle> listenerMethods = new HashMap<String, Rectangle>();
	
	public void addWindow(int x, int y, int width, int height, String title)
	{
		Window newWindow = new Window();
		newWindow.setSize(width, height);
		newWindow.setLocation(x, y);
		newWindow.title = title;
		newWindow.initBuffer();
		windows.put(title, newWindow);
	}
	
	public Graphics2D getWindow(String name)
	{
		return windows.get(name).bufferGraphics;
	}
	
	public void repaint()
	{
		for(Object item : this.windows.values().toArray())
		{
			Window window = (Window)item;
			window.paint();
		}
	}
	
	public void addMouseRegion(String method, String script, int x, int y, int width, int height)
	{
		this.listenerMethods.put(method+"|"+script, new Rectangle(x,y,width,height));
	}
	
	public String[] listenerMethods()
	{
		return this.listenerMethods.keySet().toArray(new String[0]);
	}
	
	public Rectangle region(String region)
	{
		return this.listenerMethods.get(region);
	}
}
class Window
{
	int width,height,x,y;
	String title;
	BufferedImage doubleBuffer;
	Graphics2D bufferGraphics;
	
	public void initBuffer()
	{
		doubleBuffer = new BufferedImage(this.width, this.height, BufferedImage.TYPE_4BYTE_ABGR);
		this.bufferGraphics = doubleBuffer.createGraphics();
	}
	
	public void setLocation(int x2, int y2) 
	{
		this.x = x2;
		this.y = y2;
	}

	public void setSize(int width2, int height2) 
	{
		this.width = width2;
		this.height = height2;
	}

	public void paint()
	{
		this.bufferGraphics.drawImage(LuaJava.getResource("Title_Bar"), 0, 0, width, 20, ZeroDayExploit.getInstance().rootWindow);
		Color tmpColor = this.bufferGraphics.getColor();
		this.bufferGraphics.setColor(Color.white);
		this.bufferGraphics.drawString(this.title, 5, 15);
		this.bufferGraphics.setColor(tmpColor);
		ZeroDayExploit.getScreen().drawImage(doubleBuffer, this.x, this.y, this.width, this.height, ZeroDayExploit.getInstance().rootWindow);
	}
}
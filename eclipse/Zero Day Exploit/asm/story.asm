# os/bootloader.asm #

;Wait for data to be sent
:loop:
	
	SIZ r0
	CMP r0, #0
	
	BEQ #:loop:

;Recieve the packet size
	MOV r2, #4
	MOV r0, #512
	MOV r3, #0
	
	RCV r0, r2
	
	LDR r0, r2, #0
;Wait for the packet transfer to complete
:wait:
	SIZ r4
	CMP r4, r2

	BLT #:wait:
;Store the complete packet
	RCV r0, r2
	
	DSTR r0, r3, r2, #1
	
	LDR r0, r1, #0
	SND r1, r0, r2
	
;Terminate
	HLT